{% extends 'layout/basic.html' %}

{% load thumbnail %}
{% load static %}
{% load bootstrap4 %}

{% block title %}
    Профиль пользователя
{% endblock %}

{% block content %}
    <h2>Профиль пользователя {{ user.username }}</h2>
    {% if user.first_name and user.last_name and user.teacher.middle_name %}
        <p>Здравствуйте, {{ user.last_name }} {{ user.first_name }} {{ user.teacher.middle_name }}!</p>
        <p>Ваша должность: {{ user.teacher.position }}</p>
        {% if user.teacher.degree %}
            <p>Ваша степень: {{ user.teacher.degree }}</p>
        {% else %}
            <p>Ваша степень не указана</p>
        {% endif %}
        {% if user.teacher.rank %}
            <p>Ваше звание: {{ user.teacher.rank }}</p>
        {% else %}
            <p>Ваше звание не указано</p>
        {% endif %}
    {% elif user.first_name and user.last_name %}
        <p>Здравствуйте, {{ user.first_name }} {{ user.last_name }}!</p>
    {% else %}
        <p>Здравствуйте!</p>
    {% endif %}
    {% if user.is_teacher %}
        {% if bbs %}
            <h3>Ваши объявления</h3>
            <p><a href="{% url 'main:profile_bb_add' %}">Добавить объявление</a></p>
            <ul class="list-unstyled">
                {% for bb in bbs %}
                    <li class="media my-5 p-3 border">
                        {% url 'main:profile_bb_detail' pk=bb.pk as url %}
                        <a href="{{ url }}">
                            {% if bb.image %}
                                <img class="mr-3" src="{% thumbnail bb.image 'default' %}">
                            {% else %}
                                <img class="mr-3" src="{% static 'main/empty.jpg' %}">
                            {% endif %}
                        </a>
                        <div class="media-body">
                            <p>Группа: {{ bb.group }}</p>
                            <h3><a href="{{ url }}">{{ bb.title }}</a></h3>
                            <div>{{ bb.content }}</div>
                            <p class="text-right font-italic">{{ bb.created_at }}</p>
                            <p class="text-right mt-2">
                                <a href="{% url 'main:profile_bb_change' pk=bb.pk %}">Исправить объявление</a>
                                <a href="{% url 'main:profile_bb_delete' pk=bb.pk %}">Удалить объявление</a>
                            </p>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <h3>На данный момент вы не опубликовали ни одного объявления</h3>
            <p><a href="{% url 'main:profile_bb_add' %}">Добавить объявление</a></p>
        {% endif %}
    {% else %}
        {% if bbs %}
            <h3>Объявления для вашей группы {{ user.group }} </h3>
            <ul class="list-unstyled">
                {% for bb in bbs %}
                    <li class="media my-5 p-3 border">
                        {% url 'main:profile_bb_detail' pk=bb.pk as url %}
                        <a href="{{ url }}">
                            {% if bb.image %}
                                <img class="mr-3" src="{% thumbnail bb.image 'default' %}">
                            {% else %}
                                <img class="mr-3" src="{% static 'main/empty.jpg' %}">
                            {% endif %}
                        </a>
                        <div class="media-body">
                            <p>Группа: {{ bb.group }}</p>
                            {% if bb.author.first_name and bb.author.last_name and bb.author.teacher.middle_name %}
                                <p>Автор: {{ bb.author.last_name }} {{ bb.author.first_name }}
                                    {{ bb.author.teacher.middle_name }} </p>
                            {% else %}
                                <p class="text-right font-italic">Автор: {{ bb.author.username }}</p>
                            {% endif %}
                            <h3><a href="{{ url }}">{{ bb.title }}</a></h3>
                            <div>{{ bb.content }}</div>
                            <p class="text-right font-italic">{{ bb.created_at }}</p>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <h3>На данный момент для вашей группы нет объявлений</h3>
        {% endif %}
    {% endif %}
{% endblock %}